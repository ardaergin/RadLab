---
title: "Radicalization Lab"
subtitle: "Code sheet 3: Combining datasets"
author: "Arda Ergin"
output:
  rmdformats::downcute:
    downcute_theme: "chaos"
---

# Setup
IMPORTANT FOR THE USER OF THIS SCRIPT: you have to load the R package "**RadLab**". This is necessary for the code to work properly. See [the GitHub repository](https://github.com/ardaergin/RadLab) for further information.           

The code below loads the RadLab package, you need to download the "devtools" package first, you can do so with install.packages("devtools").
```{r, message=FALSE, warning=FALSE}
# devtools::install_github("ardaergin/RadLab")
# library(RadLab)
devtools::load_all(".")
library(dplyr)
library(tidyr)
library(ggplot2)
library(stats)
library(lme4)
library(compositions)
library(zCompositions)
```



```{r}
load("../data/data_working/d_study1.Rdata")
load("../data/data_working/d_study2.Rdata")
load("../data/data_working/d_study3.Rdata")
load("../data/data_working/d_study4.Rdata")
load("../data/data_working/d_study5.Rdata")
load("../data/data_working/d_study6.Rdata")
load("../data/data_working/d_study7.Rdata")
load("../data/data_working/d_study8.Rdata")
```

```{r}
# For d_study1
data <- d_study1
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_1 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_1)

ilr2_model_1 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_1)

ilr3_model_1 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_1)

# For d_study2
data <- d_study2
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_2 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_2)

ilr2_model_2 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_2)

ilr3_model_2 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_2)

# For d_study3
data <- d_study3
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_3 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_3)

ilr2_model_3 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_3)

ilr3_model_3 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_3)

# For d_study4
data <- d_study4
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_4 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_4)

ilr2_model_4 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_4)

ilr3_model_4 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_4)

# For d_study5
data <- d_study5
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_5 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_5)

ilr2_model_5 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_5)

ilr3_model_5 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_5)

# For d_study6
data <- d_study6
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_6 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_6)

ilr2_model_6 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_6)

ilr3_model_6 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_6)

# For d_study7
data <- d_study7
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_7 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_7)

ilr2_model_7 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_7)

ilr3_model_7 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_7)

# For d_study8
data <- d_study8
ilr_data <- RadLab::prepare_compositional_data(data)

ilr1_model_8 <- lmerTest::lmer(
  ilr1 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr1_model_8)

ilr2_model_8 <- lmerTest::lmer(
  ilr2 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr2_model_8)

ilr3_model_8 <- lmerTest::lmer(
  ilr3 ~ time + excluded + injustice + personal + violence +
    (1 + time | ID),
  data = ilr_data,
  control = lmerControl(optimizer = "bobyqa")
)
summary(ilr3_model_8)
```


```{r}
load('../models/mcmc_results.Rdata')

summary(mcmc_model)

library(MCMCglmm)

summary(mcmc_model)
```



